<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <title>B2 Exam Companion ‚Äì TELC & Goethe</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="description" content="Tracker, Schreibtrainer und √úbungstests zur Vorbereitung auf Goethe- und telc-B2-Pr√ºfungen." />
  <style>
    :root {
      --bg: #f5f5f5;
      --card-bg: #ffffff;
      --primary: #2563eb;
      --primary-soft: #dbeafe;
      --border: #e5e7eb;
      --text-main: #111827;
      --text-muted: #6b7280;
      --radius-lg: 14px;
    }

    * { box-sizing: border-box; }

    body {
      margin: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: var(--bg);
      color: var(--text-main);
      line-height: 1.5;
    }

    .app {
      max-width: 960px;
      margin: 0 auto;
      padding: 16px;
    }

    header {
      display: flex;
      flex-wrap: wrap;
      align-items: center;
      justify-content: space-between;
      gap: 8px;
      margin-bottom: 16px;
    }

    .brand {
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .logo {
      width: 32px;
      height: 32px;
      border-radius: 999px;
      background: var(--primary-soft);
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 800;
      color: var(--primary);
      font-size: 0.95rem;
    }

    h1 {
      font-size: 1.3rem;
      margin: 0;
    }

    .subtitle {
      font-size: 0.8rem;
      color: var(--text-muted);
    }

    nav {
      display: flex;
      gap: 4px;
      background: #e5e7eb;
      border-radius: 999px;
      padding: 3px;
    }

    .nav-btn {
      border: none;
      background: transparent;
      padding: 6px 14px;
      border-radius: 999px;
      font-size: 0.85rem;
      cursor: pointer;
      color: var(--text-muted);
      white-space: nowrap;
    }

    .nav-btn.active {
      background: var(--card-bg);
      color: var(--primary);
      font-weight: 600;
      box-shadow: 0 1px 4px rgba(0,0,0,0.08);
    }

    .card {
      background: var(--card-bg);
      border-radius: var(--radius-lg);
      box-shadow: 0 2px 6px rgba(0,0,0,0.06);
      padding: 16px;
      margin-bottom: 16px;
    }

    h2 {
      margin-top: 0;
      font-size: 1.05rem;
    }

    h3 {
      margin-top: 0.3rem;
      font-size: 0.95rem;
    }

    label {
      display: block;
      margin-bottom: 4px;
      font-weight: 600;
      font-size: 0.85rem;
    }

    select, input, textarea {
      width: 100%;
      padding: 8px;
      margin-bottom: 10px;
      border-radius: 10px;
      border: 1px solid #d1d5db;
      font-size: 0.9rem;
      font-family: inherit;
      background: #f9fafb;
    }

    textarea {
      min-height: 60px;
      resize: vertical;
    }

    button {
      border-radius: 10px;
      padding: 8px 12px;
      font-size: 0.9rem;
      font-family: inherit;
      cursor: pointer;
      border: none;
    }

    .btn-primary {
      background: var(--primary);
      color: #ffffff;
      font-weight: 600;
    }

    .btn-secondary {
      background: #e5e7eb;
      color: var(--text-main);
      font-weight: 500;
    }

    button:disabled {
      opacity: 0.6;
      cursor: default;
    }

    .row { display: flex; gap: 8px; }
    .row > * { flex: 1; }

    .status {
      font-size: 0.85rem;
      color: var(--text-muted);
      margin-bottom: 8px;
    }

    .status span {
      font-weight: 600;
      color: var(--text-main);
    }

    table {
      width: 100%;
      border-collapse: collapse;
      font-size: 0.85rem;
      margin-top: 8px;
    }

    th, td {
      padding: 6px 4px;
      border-bottom: 1px solid var(--border);
      text-align: left;
      vertical-align: top;
    }

    th {
      background: #f3f4f6;
      font-weight: 600;
    }

    .tag {
      display: inline-block;
      padding: 2px 7px;
      border-radius: 999px;
      font-size: 0.7rem;
      background: #e5e7eb;
      margin-right: 4px;
      margin-bottom: 2px;
    }

    .tag-listening { background: #dbeafe; }
    .tag-reading   { background: #dcfce7; }
    .tag-writing   { background: #fee2e2; }

    .totals {
      font-size: 0.9rem;
      margin-top: 6px;
      color: var(--text-main);
    }

    .pill {
      display: inline-flex;
      align-items: center;
      gap: 4px;
      background: #eff6ff;
      color: #1d4ed8;
      padding: 3px 8px;
      border-radius: 999px;
      font-size: 0.75rem;
      margin-bottom: 6px;
    }

    .chips {
      display: flex;
      flex-wrap: wrap;
      gap: 4px;
      margin-bottom: 8px;
    }

    .chip {
      font-size: 0.75rem;
      padding: 3px 8px;
      border-radius: 999px;
      background: #f3f4f6;
      cursor: pointer;
    }

    .chip:hover { background: #e5e7eb; }

    .phrase-block { margin-bottom: 12px; }

    .phrase-title {
      font-weight: 600;
      font-size: 0.9rem;
      margin-bottom: 4px;
    }

    .phrase-list {
      font-size: 0.85rem;
      margin-left: 12px;
    }

    .phrase-list li { margin-bottom: 2px; }

    .hint {
      font-size: 0.8rem;
      color: var(--text-muted);
      margin-bottom: 4px;
    }

    .template-box {
      border: 1px solid #e5e7eb;
      border-radius: 10px;
      padding: 8px;
      background: #f9fafb;
      font-size: 0.85rem;
      white-space: pre-wrap;
      margin-bottom: 10px;
    }

    .about-text {
      font-size: 0.9rem;
      color: var(--text-main);
    }

    .about-text p {
      margin-top: 0;
      margin-bottom: 8px;
    }

    .badge {
      display: inline-block;
      background: #f97316;
      color: #fff;
      font-size: 0.7rem;
      padding: 2px 8px;
      border-radius: 999px;
      margin-left: 6px;
    }

    /* Tests */
    .test-text {
      font-size: 0.9rem;
      margin-bottom: 8px;
    }

    .question-block {
      margin-bottom: 10px;
      padding: 6px 0;
      border-bottom: 1px dashed #e5e7eb;
    }

    .question-title {
      font-weight: 600;
      font-size: 0.9rem;
      margin-bottom: 4px;
    }

    .answer-option {
      display: block;
      font-size: 0.85rem;
      margin-bottom: 2px;
    }

    .feedback {
      font-size: 0.8rem;
      margin-top: 4px;
    }

    .feedback.ok { color: #16a34a; }
    .feedback.bad { color: #b91c1c; }

    .result-summary {
      font-size: 0.9rem;
      margin-top: 8px;
      font-weight: 600;
    }

    .transcript-box {
      border-radius: 10px;
      border: 1px solid #e5e7eb;
      padding: 8px;
      background: #f9fafb;
      font-size: 0.85rem;
      margin-top: 8px;
      white-space: pre-wrap;
    }

    .ki-box {
      border-radius: 10px;
      border: 1px dashed #9ca3af;
      background: #f9fafb;
      padding: 8px;
      font-size: 0.8rem;
      margin-top: 8px;
    }

    @media (max-width: 640px) {
      header { flex-direction: column; align-items: flex-start; }
      nav { width: 100%; }
      .row { flex-direction: column; }
    }
  </style>
</head>
<body>
  <div class="app">
    <header>
      <div class="brand">
        <div class="logo">B2</div>
        <div>
          <h1>B2 Exam Companion</h1>
          <div class="subtitle">Tracker, Schreiben & Tests f√ºr Goethe / telc B2</div>
        </div>
      </div>
      <nav>
        <button class="nav-btn active" data-section="tracker">Tracker</button>
        <button class="nav-btn" data-section="tests">Tests</button>
        <button class="nav-btn" data-section="schreiben">Schreiben B2</button>
        <button class="nav-btn" data-section="about">About</button>
      </nav>
    </header>

    <!-- TRACKER SECTION -->
    <section id="section-tracker">
      <div class="card">
        <h2>Study Tracker</h2>
        <div class="pill">‚è± Nur im Browser gespeichert ‚Äì keine Registrierung</div>

        <label for="taskType">Aufgabentyp</label>
        <select id="taskType">
          <option value="Lesen">Lesen (Reading)</option>
          <option value="H√∂ren">H√∂ren (Listening)</option>
          <option value="Schreiben">Schreiben (Writing)</option>
          <option value="Grammatik">Grammatik</option>
          <option value="Wortschatz">Wortschatz</option>
        </select>

        <label for="examType">Pr√ºfungsformat (optional)</label>
        <select id="examType">
          <option value="">‚Äî nicht ausgew√§hlt ‚Äî</option>
          <option value="Goethe B2">Goethe B2</option>
          <option value="telc B2">telc B2</option>
          <option value="Allgemein">Allgemeines Training</option>
        </select>

        <label for="description">Was genau machst du?</label>
        <textarea id="description" placeholder="z.B. Goethe B2 Modelltest 1 ‚Äì Lesen, Teil 1"></textarea>

        <div class="chips">
          <div class="chip" data-desc="Goethe B2 Modelltest ‚Äì Lesen, Teil 1">Lesen Teil 1</div>
          <div class="chip" data-desc="Goethe B2 Modelltest ‚Äì H√∂ren, Teil 3">H√∂ren Teil 3</div>
          <div class="chip" data-desc="telc B2 ‚Äì Schriftliche Pr√ºfung, Teil 1 (Formeller Brief)">telc Brief</div>
        </div>

        <div class="status" id="timerStatus">
          ‚è≥ Timer nicht gestartet.
        </div>

        <div class="row">
          <button id="startBtn" class="btn-primary">‚ñ∂ Start</button>
          <button id="stopBtn" class="btn-secondary" disabled>‚èπ Stop & Speichern</button>
        </div>
      </div>

      <div class="card">
        <h2>Statistik</h2>
        <div class="totals" id="totals">Noch keine Daten.</div>
        <table id="sessionsTable">
          <thead>
            <tr>
              <th>Datum</th>
              <th>Typ</th>
              <th>Beschreibung</th>
              <th>Dauer (Min)</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>
    </section>

    <!-- TESTS SECTION -->
    <section id="section-tests" style="display:none;">
      <div class="card">
        <h2>Lesen ‚Äì Beispieltest B2</h2>
        <div class="hint">
          Lies den Text und beantworte die Fragen. Danach bekommst du eine Auswertung mit Erkl√§rungen.
        </div>
        <div class="test-text">
          Immer mehr Menschen lernen Sprachen online. Sie entscheiden sich f√ºr digitale Kurse, weil sie flexibler sind als traditionelle Sprachschulen. 
          Man kann lernen, wann und wo man m√∂chte. Besonders Berufst√§tige und Eltern mit kleinen Kindern profitieren davon. 
          Allerdings braucht das Lernen zu Hause viel Selbstdisziplin. Wer keinen festen Lernplan hat, vergisst schnell seine Ziele 
          und macht l√§ngere Pausen. Viele Plattformen versuchen deshalb, die Lernenden mit Erinnerungen, Lernstatistiken und kleinen 
          Erfolgsmeldungen zu motivieren.
        </div>

        <form id="lesenForm">
          <div class="question-block">
            <div class="question-title">1. Worum geht es in diesem Text haupts√§chlich?</div>
            <label class="answer-option">
              <input type="radio" name="lesen_q1" value="a" />
              A: Um technische Probleme beim Online-Unterricht
            </label>
            <label class="answer-option">
              <input type="radio" name="lesen_q1" value="b" />
              B: Um Vorteile und Herausforderungen von Online-Sprachkursen
            </label>
            <label class="answer-option">
              <input type="radio" name="lesen_q1" value="c" />
              C: Um neue Pr√ºfungsformate an Sprachschulen
            </label>
            <div class="feedback" id="feedback-lesen_q1"></div>
          </div>

          <div class="question-block">
            <div class="question-title">2. Welche Personengruppe wird als Beispiel genannt?</div>
            <label class="answer-option">
              <input type="radio" name="lesen_q2" value="a" />
              A: Sch√ºler, die viel reisen
            </label>
            <label class="answer-option">
              <input type="radio" name="lesen_q2" value="b" />
              B: Berufst√§tige und Eltern mit kleinen Kindern
            </label>
            <label class="answer-option">
              <input type="radio" name="lesen_q2" value="c" />
              C: Rentner, die neue Hobbys suchen
            </label>
            <div class="feedback" id="feedback-lesen_q2"></div>
          </div>

          <div class="question-block">
            <div class="question-title">3. Warum nutzen Plattformen Erinnerungen und Statistiken?</div>
            <label class="answer-option">
              <input type="radio" name="lesen_q3" value="a" />
              A: Weil viele Menschen sonst ihre Motivation verlieren
            </label>
            <label class="answer-option">
              <input type="radio" name="lesen_q3" value="b" />
              B: Um technische Probleme schneller zu l√∂sen
            </label>
            <label class="answer-option">
              <input type="radio" name="lesen_q3" value="c" />
              C: Damit die Kurse g√ºnstiger werden
            </label>
            <div class="feedback" id="feedback-lesen_q3"></div>
          </div>

          <button type="button" class="btn-primary" id="checkLesenBtn">Antworten √ºberpr√ºfen</button>
        </form>
        <div id="lesenResultSummary" class="result-summary"></div>
      </div>

      <div class="card">
        <h2>H√∂ren ‚Äì Beispiel B2</h2>
        <div class="hint">
          1. H√∂re den kurzen Text. 2. Beantworte die Fragen. 3. Schau dir das Transkript an, wenn n√∂tig.
        </div>

        <!--
          –ê–£–î–ò–û:
          - —Å–æ–∑–¥–∞–π –ø–∞–ø–∫—É "audio" –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏
          - –∑–∞–ø–∏—à–∏ —ç—Ç–æ—Ç —Ç–µ–∫—Å—Ç –≤ mp3 (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Ç–µ–ª–µ—Ñ–æ–Ω–æ–º) –∏ –Ω–∞–∑–æ–≤–∏ —Ñ–∞–π–ª "hoeren1.mp3"
          - –∑–∞–≥—Ä—É–∑–∏ –≤ –ø–∞–ø–∫—É audio
        -->
        <audio controls>
          <source src="audio/hoeren1.mp3" type="audio/mpeg" />
          Dein Browser unterst√ºtzt das Audio-Element nicht.
        </audio>

        <div class="hint">
          Wenn noch keine eigene Aufnahme vorhanden ist, bleibt der Player einfach stumm, bis du die Datei hochl√§dst.
        </div>

        <div style="margin-top:8px;">
          <button type="button" class="btn-secondary" id="toggleTranscriptBtn">
            Transkript anzeigen
          </button>
          <div id="transcriptBox" class="transcript-box" style="display:none;">
Heute sprechen viele Menschen dar√ºber, wie sie am liebsten lernen. 
Manche besuchen einen klassischen Kurs in der Sprachschule. 
Andere h√∂ren lieber Podcasts oder schauen Lernvideos auf dem Handy. 
Wichtig ist nicht nur das Material, sondern auch, dass man regelm√§√üig √ºbt. 
Schon 20 Minuten am Tag k√∂nnen einen gro√üen Unterschied machen.
          </div>
        </div>

        <form id="hoerenForm" style="margin-top:10px;">
          <div class="question-block">
            <div class="question-title">1. Was ist das Hauptthema des H√∂rtexts?</div>
            <label class="answer-option">
              <input type="radio" name="hoeren_q1" value="a" />
              A: Welche Apps technisch am besten funktionieren
            </label>
            <label class="answer-option">
              <input type="radio" name="hoeren_q1" value="b" />
              B: Verschiedene M√∂glichkeiten, wie Menschen lernen
            </label>
            <label class="answer-option">
              <input type="radio" name="hoeren_q1" value="c" />
              C: Die Geschichte der Sprachschulen
            </label>
            <div class="feedback" id="feedback-hoeren_q1"></div>
          </div>

          <div class="question-block">
            <div class="question-title">2. Was ist laut dem Text besonders wichtig?</div>
            <label class="answer-option">
              <input type="radio" name="hoeren_q2" value="a" />
              A: Teure Lehrb√ºcher zu kaufen
            </label>
            <label class="answer-option">
              <input type="radio" name="hoeren_q2" value="b" />
              B: Dass man jeden Tag ein bisschen √ºbt
            </label>
            <label class="answer-option">
              <input type="radio" name="hoeren_q2" value="c" />
              C: Nur Podcasts zu benutzen
            </label>
            <div class="feedback" id="feedback-hoeren_q2"></div>
          </div>

          <button type="button" class="btn-primary" id="checkHoerenBtn">Antworten √ºberpr√ºfen</button>
        </form>
        <div id="hoerenResultSummary" class="result-summary"></div>
      </div>
    </section>

    <!-- SCHREIBEN SECTION -->
    <section id="section-schreiben" style="display:none;">
      <div class="card">
        <h2>Schreiben B2 ‚Äì Templates & Phrasen</h2>
        <div class="hint">
          Nutze diese Bausteine f√ºr Goethe- und telc-B2-Briefe. Du kannst Text direkt markieren & kopieren.
        </div>

        <h3>1. Formelle Anfrage / Bitte um Information</h3>
        <div class="template-box">
Sehr geehrte Damen und Herren,

ich habe Ihre Anzeige auf ... gelesen und interessiere mich sehr f√ºr ...
In diesem Zusammenhang h√§tte ich einige Fragen.

Erstens w√ºrde ich gern wissen, ...
Au√üerdem interessiert mich, ...
K√∂nnten Sie mir bitte mitteilen, ...

Ich w√ºrde mich sehr √ºber eine baldige Antwort freuen.

Mit freundlichen Gr√º√üen
[Ihr Name]
        </div>

        <h3>2. Beschwerde / Reklamation</h3>
        <div class="template-box">
Sehr geehrte Damen und Herren,

ich wende mich an Sie, weil ich mit ... nicht zufrieden bin.
Am [Datum] habe ich bei Ihnen ... gekauft/gebucht.

Leider musste ich feststellen, dass ...
Au√üerdem ...

Aus diesem Grund m√∂chte ich Sie bitten, ...
Ich hoffe, dass wir eine zufriedenstellende L√∂sung finden k√∂nnen.

Mit freundlichen Gr√º√üen
[Ihr Name]
        </div>

        <h3>3. Meinung √§u√üern / Stellungnahme</h3>
        <div class="template-box">
Einleitung:
In letzter Zeit wird oft dar√ºber diskutiert, ob ...
In diesem Text m√∂chte ich meine Meinung zu diesem Thema √§u√üern.

Argument 1:
Zun√§chst spricht daf√ºr, dass ...
Au√üerdem ...

Argument 2 (Gegenargument):
Auf der anderen Seite gibt es auch Nachteile. Zum Beispiel ...
Viele Menschen meinen, dass ...

Eigene Meinung:
Meiner Meinung nach ...
Ich bin der Ansicht, dass ...

Schluss:
Zusammenfassend l√§sst sich sagen, dass ...
Deshalb bin ich daf√ºr/dagegen, dass ...
        </div>
      </div>

      <div class="card">
        <h2>KI-Schreibanalyse (Prototype)</h2>
        <div class="hint">
          Hier siehst du, wie sp√§ter die KI-Analyse aussehen kann. In dieser reinen GitHub-Pages-Version gibt es noch keinen echten Server,
          deshalb ist das Feedback unten nur eine Demo-Nachricht.
        </div>

        <textarea id="kiText" placeholder="Schreibe hier deinen B2-Text (E-Mail, Meinungstext, Beschwerde) ..."></textarea>
        <button type="button" class="btn-primary" id="kiAnalyzeBtn">Pseudo-Analyse anzeigen</button>

        <div id="kiFeedback" class="ki-box" style="display:none;">
          <strong>Beispiel-Feedback (Demo):</strong>
          <ul>
            <li>‚û§ Der Text hat eine klare Einleitung, k√∂nnte aber eine deutlichere Schlussfolgerung enthalten.</li>
            <li>‚û§ Achte auf Gro√ü- und Kleinschreibung bei Nomen (z.B. <em>deutsch</em> ‚Üí <em>Deutsch</em>).</li>
            <li>‚û§ Einige S√§tze sind sehr lang. Trenne sie, damit der Text besser lesbar wird.</li>
          </ul>
          <div class="hint">
            In einer echten App w√ºrde hier die Antwort der KI stehen. Daf√ºr braucht man einen Server mit OpenAI-API ‚Äì das k√∂nnen wir als n√§chsten Schritt planen.
          </div>
        </div>
      </div>
    </section>

    <!-- ABOUT SECTION -->
    <section id="section-about" style="display:none;">
      <div class="card">
        <h2>About B2 Exam Companion <span class="badge">MVP</span></h2>
        <div class="about-text">
          <p>Dieses kleine Tool hilft Lernenden, sich auf <strong>Goethe-</strong> und <strong>telc-B2-Pr√ºfungen</strong> vorzubereiten:</p>
          <ul>
            <li>‚è± <strong>Tracker</strong>: Miss deine Lernzeit f√ºr Lesen, H√∂ren, Schreiben usw.</li>
            <li>‚úçÔ∏è <strong>Schreiben-Bereich</strong>: Vorlagen & Phrasen f√ºr typische B2-Aufgaben.</li>
            <li>üìù <strong>Tests</strong>: Beispieltests f√ºr Lesen und H√∂ren mit Erkl√§rungen.</li>
            <li>üîê <strong>Datenschutz</strong>: Alle Daten werden nur im Browser (localStorage) gespeichert.</li>
          </ul>
          <p>N√§chster Schritt: echter KI-Server f√ºr automatische Korrektur von B2-Texten und mehr Tests (Lesen/H√∂ren) als Bibliothek.</p>
        </div>
      </div>
    </section>
  </div>

  <script>
    // ---------- NAVIGATION ----------
    const navButtons = document.querySelectorAll('.nav-btn');
    const sections = {
      tracker: document.getElementById('section-tracker'),
      tests: document.getElementById('section-tests'),
      schreiben: document.getElementById('section-schreiben'),
      about: document.getElementById('section-about')
    };

    navButtons.forEach(btn => {
      btn.addEventListener('click', () => {
        const target = btn.getAttribute('data-section');
        navButtons.forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        Object.entries(sections).forEach(([key, section]) => {
          section.style.display = key === target ? 'block' : 'none';
        });
      });
    });

    // ---------- TRACKER ----------
    const startBtn = document.getElementById('startBtn');
    const stopBtn = document.getElementById('stopBtn');
    const timerStatus = document.getElementById('timerStatus');
    const taskTypeEl = document.getElementById('taskType');
    const examTypeEl = document.getElementById('examType');
    const descriptionEl = document.getElementById('description');
    const sessionsTableBody = document.querySelector('#sessionsTable tbody');
    const totalsEl = document.getElementById('totals');
    const chips = document.querySelectorAll('.chip');

    let startTime = null;

    function loadSessions() {
      const raw = localStorage.getItem('studySessions_b2');
      if (!raw) return [];
      try { return JSON.parse(raw); } catch { return []; }
    }

    function saveSessions(sessions) {
      localStorage.setItem('studySessions_b2', JSON.stringify(sessions));
    }

    function formatDate(dateStr) {
      const d = new Date(dateStr);
      if (Number.isNaN(d.getTime())) return dateStr;
      return d.toLocaleDateString('de-DE', {
        year: 'numeric', month: '2-digit', day: '2-digit'
      });
    }

    function renderSessions() {
      const sessions = loadSessions();
      sessionsTableBody.innerHTML = '';

      if (sessions.length === 0) {
        totalsEl.textContent = 'Noch keine Daten.';
        return;
      }

      let totalMinutes = 0;
      const totalsByType = {};

      sessions.forEach(session => {
        totalMinutes += session.durationMinutes;
        totalsByType[session.taskType] =
          (totalsByType[session.taskType] || 0) + session.durationMinutes;

        const tr = document.createElement('tr');

        const dateTd = document.createElement('td');
        dateTd.textContent = formatDate(session.date);

        const typeTd = document.createElement('td');
        const typeSpan = document.createElement('span');
        typeSpan.textContent = session.taskType;
        typeSpan.classList.add('tag');
        if (session.taskType === 'H√∂ren') typeSpan.classList.add('tag-listening');
        if (session.taskType === 'Lesen') typeSpan.classList.add('tag-reading');
        if (session.taskType === 'Schreiben') typeSpan.classList.add('tag-writing');
        typeTd.appendChild(typeSpan);

        if (session.examType) {
          const examSpan = document.createElement('span');
          examSpan.textContent = session.examType;
          examSpan.classList.add('tag');
          typeTd.appendChild(examSpan);
        }

        const descTd = document.createElement('td');
        descTd.textContent = session.description || '‚Äî';

        const durTd = document.createElement('td');
        durTd.textContent = session.durationMinutes.toFixed(1).replace('.', ',');

        tr.appendChild(dateTd);
        tr.appendChild(typeTd);
        tr.appendChild(descTd);
        tr.appendChild(durTd);

        sessionsTableBody.appendChild(tr);
      });

      let totalsText = `Gesamt: ${totalMinutes.toFixed(1)} Min.`;
      totalsText += ' | Nach Typ: ';
      totalsText += Object.entries(totalsByType)
        .map(([type, mins]) => `${type}: ${mins.toFixed(1)} Min.`)
        .join(' ‚Ä¢ ');

      totalsEl.textContent = totalsText;
    }

    function startTimer() {
      if (startTime !== null) return;
      startTime = Date.now();
      timerStatus.innerHTML = '‚è≥ Timer l√§uft ...';
      startBtn.disabled = true;
      stopBtn.disabled = false;
    }

    function stopTimer() {
      if (startTime === null) return;
      const endTime = Date.now();
      const diffMs = endTime - startTime;
      const minutes = diffMs / 60000;

      if (minutes < 0.1) {
        timerStatus.innerHTML = '‚ö† Zu kurze Sitzung, nicht gespeichert.';
        startTime = null;
        startBtn.disabled = false;
        stopBtn.disabled = true;
        return;
      }

      const sessions = loadSessions();
      const rounded = Math.round(minutes * 10) / 10;
      const newSession = {
        date: new Date().toISOString(),
        taskType: taskTypeEl.value,
        examType: examTypeEl.value || '',
        description: descriptionEl.value.trim(),
        durationMinutes: rounded
      };

      sessions.push(newSession);
      saveSessions(sessions);

      timerStatus.innerHTML = `‚úÖ Gespeichert: ${rounded.toFixed(1)} Min.`;
      startTime = null;
      startBtn.disabled = false;
      stopBtn.disabled = true;
      renderSessions();
    }

    startBtn.addEventListener('click', startTimer);
    stopBtn.addEventListener('click', stopTimer);

    chips.forEach(chip => {
      chip.addEventListener('click', () => {
        const text = chip.getAttribute('data-desc');
        descriptionEl.value = text;
      });
    });

    renderSessions();

    // ---------- LESEN-TEST ----------
    const lesenAnswerKey = {
      lesen_q1: {
        correct: 'b',
        explanation: 'Im Text werden sowohl Vorteile als auch Schwierigkeiten von Online-Sprachkursen beschrieben.'
      },
      lesen_q2: {
        correct: 'b',
        explanation: 'Es werden ausdr√ºcklich Berufst√§tige und Eltern mit kleinen Kindern erw√§hnt.'
      },
      lesen_q3: {
        correct: 'a',
        explanation: 'Erinnerungen und Statistiken sollen helfen, dass Lernende motiviert bleiben und keine langen Pausen machen.'
      }
    };

    const checkLesenBtn = document.getElementById('checkLesenBtn');
    const lesenResultSummary = document.getElementById('lesenResultSummary');

    checkLesenBtn.addEventListener('click', () => {
      let correctCount = 0;
      const total = Object.keys(lesenAnswerKey).length;

      Object.entries(lesenAnswerKey).forEach(([qId, info]) => {
        const selected = document.querySelector(`input[name="${qId}"]:checked`);
        const feedbackEl = document.getElementById(`feedback-${qId}`);

        if (!selected) {
          feedbackEl.textContent = 'Keine Antwort ausgew√§hlt.';
          feedbackEl.className = 'feedback bad';
          return;
        }

        if (selected.value === info.correct) {
          correctCount++;
          feedbackEl.textContent = 'Richtig. ' + info.explanation;
          feedbackEl.className = 'feedback ok';
        } else {
          const letter = info.correct.toUpperCase();
          feedbackEl.textContent = `Falsch. Richtige Antwort: ${letter}. ` + info.explanation;
          feedbackEl.className = 'feedback bad';
        }
      });

      lesenResultSummary.textContent =
        `Du hast ${correctCount} von ${total} Fragen richtig beantwortet.`;
    });

    // ---------- H√ñREN-TEST ----------
    const hoerenAnswerKey = {
      hoeren_q1: {
        correct: 'b',
        explanation: 'Der Text nennt verschiedene Lernformen: Sprachschule, Podcasts, Lernvideos.'
      },
      hoeren_q2: {
        correct: 'b',
        explanation: 'Es wird gesagt, dass schon 20 Minuten am Tag einen gro√üen Unterschied machen.'
      }
    };

    const checkHoerenBtn = document.getElementById('checkHoerenBtn');
    const hoerenResultSummary = document.getElementById('hoerenResultSummary');

    checkHoerenBtn.addEventListener('click', () => {
      let correctCount = 0;
      const total = Object.keys(hoerenAnswerKey).length;

      Object.entries(hoerenAnswerKey).forEach(([qId, info]) => {
        const selected = document.querySelector(`input[name="${qId}"]:checked`);
        const feedbackEl = document.getElementById(`feedback-${qId}`);

        if (!selected) {
          feedbackEl.textContent = 'Keine Antwort ausgew√§hlt.';
          feedbackEl.className = 'feedback bad';
          return;
        }

        if (selected.value === info.correct) {
          correctCount++;
          feedbackEl.textContent = 'Richtig. ' + info.explanation;
          feedbackEl.className = 'feedback ok';
        } else {
          const letter = info.correct.toUpperCase();
          feedbackEl.textContent = `Falsch. Richtige Antwort: ${letter}. ` + info.explanation;
          feedbackEl.className = 'feedback bad';
        }
      });

      hoerenResultSummary.textContent =
        `Du hast ${correctCount} von ${total} Fragen richtig beantwortet.`;
    });

    // ---------- TRANSKRIPT ----------
    const toggleTranscriptBtn = document.getElementById('toggleTranscriptBtn');
    const transcriptBox = document.getElementById('transcriptBox');

    toggleTranscriptBtn.addEventListener('click', () => {
      const visible = transcriptBox.style.display !== 'none';
      transcriptBox.style.display = visible ? 'none' : 'block';
      toggleTranscriptBtn.textContent = visible
        ? 'Transkript anzeigen'
        : 'Transkript verbergen';
    });

    // ---------- KI-DEMO ----------
    const kiBtn = document.getElementById('kiAnalyzeBtn');
    const kiBox = document.getElementById('kiFeedback');
    const kiText = document.getElementById('kiText');

    kiBtn.addEventListener('click', () => {
      if (!kiText.value.trim()) {
        alert('Bitte schreibe zuerst einen Text.');
        return;
      }
      kiBox.style.display = 'block';
      // –ó–¥–µ—Å—å –ü–û–ö–ê –Ω–µ—Ç –Ω–∞—Å—Ç–æ—è—â–µ–≥–æ –∑–∞–ø—Ä–æ—Å–∞ –∫ –ò–ò.
      // –í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –∫–Ω–æ–ø–∫–∞ –±—É–¥–µ—Ç –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å —Ç–µ–∫—Å—Ç –Ω–∞ —Å–µ—Ä–≤–µ—Ä —Å OpenAI-API.
    });
  </script>
</body>
</html>
